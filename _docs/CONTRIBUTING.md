# Соглашения и рекомендации по разработке

В данном разделе приведены основные соглашения по разработке, установленные внутри команды.

## Ветвление, CI, MR, релизная политика

Разработка решения ведется с использованием многих ключевых практик XP, в т.ч. непрерывная интеграция, итерационная
разработка, Code Review.

Процесс разработки и контроля версий построен с использованием стандартных
подходов [GitFlow](https://www.atlassian.com/ru/git/tutorials/comparing-workflows/gitflow-workflow), в ветке `master`
содержится текущий актуальный релиз, все исторические релизы доступны по тегам, в ветке `develop` доступная текущая
дев-версия системы. Выпуск новых версий осуществляется путем слияния в `master` вертку с тегом `release-***`.

Разработка ведется итеративно с планирование бэклога по месячным итерациям с выпуском нового релиза в конце каждой
итерации.

Часто выполняйте `push-pull` согласно практикам непрерывной интеграции для синхронизации работ внутри команды, не
бойтесь разбивать работу на небольшие коммиты, объединяйте в коммите общие блоки.

Используйте feature-ветки для создания нового функционала, именуйте ветки "feature/name-of-function" предпочитая "-" в
качестве разделителя.
Прямые коммиты в develop допускаются только в исключительных случаях и только разработчикам с ролью Maintainer. В
feature-ветках допускается commit в незавершенном или нерабочем состоянии.

## Оформление Merge Request и Code-review

Для feature-веток оформляйте Merge Request (MR) в develop-ветку. Для каждого MR настроены правила по автоматической
сборке и прогону тестов (при наличии) и синтаксической проверке, следите за корректным выполнением всех сборок в рамках
MR.

Приветствуется оформление MR заранее с использованием стандартных префиксов 'WIP:' (Work in progress) и 'Draft:' для
обозначения заготовок MR. Такие MR могут использоваться для проверки корректности сборок в feature-ветках.

Оформляйте Merge Request с использованием заготовки шаблона, приводите краткое описание сделанного функционала и
указывайте связанные задачи с использованием '#' и номера связанных Issues.

Для Merge Request принята практика проведении перекрестного Code-Review. Состав ревьюверов определяется разработчиками с
ролью Maintainer, список участников Code Review указывается в описании MR, упоминайте ревьюверов c использованием '@'.

Используйте комментирование MR для выполнения Code-review, комментируйте конкретные строки кода при наличии вопросов,
замечаний или предложений. При подготовке замечаний и предложений руководствуйтесь правилами взаимного самоуважения и
старайтесь использовать конструктивные утверждения.

## Исходный код

- Следуйте правилам оформления исходного
  кода [общие соглашения о коде C#](https://learn.microsoft.com/ru-ru/dotnet/csharp/fundamentals/coding-style/coding-conventions)
- По возможности пишите [самодокументируемый код](https://habr.com/ru/post/458264/)
- При именовании объектов придерживайтесь английского языка и подбора корректных доменных терминов
- При проектировании классов придерживайтесь принципов SOLID (https://en.wikipedia.org/wiki/SOLID), а также по
  возможности классическими принципами `KISS`, `DRY` и `YAGNI`
- При проектировании архитектуры решения придерживайтесь принципов чистой
  архитектуры (https://github.com/jasontaylordev/CleanArchitecture)

## Форматирование кода C#

https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions  
https://github.com/dotnet/runtime/blob/main/docs/coding-guidelines/coding-style.md

Плюс некоторые рекомендации для красоты и читаемости:

- Блок кода отделяется пустыми строками

```c#
var a = new [];

foreach (var item in a)
{
	// some work
}

var b = new [];
var c = new [];

foreach (var item in b)
{
	// some b work
}

return;

```

- Ковычки рядом не разделяются пустыми строками

```c#
function void Func(string[] a)
{
	foreach (var item in a)
	{
		// some work
	}
}

```

- Члены класса разделяются пустыми строками
- Две пустых строки рядом делать **не нужно**
- _Рекомендуемая_ сортировка членов класса: статические свойства, обычные свойства, конструкторы, статические функции,
  обычные функции
- _Рекомендуемая_ сортировка полей и функций класса сверху public снизу private
- Использование file-scoped namespace
- Использование доступной нормальной ширины экрана в 130 символов. Не надо переносить выражение если в каждой строке
  будет по 30 символов
- Высота кода функции не должна превышать один экран

## Автоматизированное тестирование

При написании тестов четко разделяйте их по типам: юнит-тесты, интеграционные тесты, функциональные тесты / e2e.

Используйте TDD или отладку с помощью юнит-тестов только для тех блоков, которым не свойственно частое изменение или
модификация.

Перед написанием тестов руководствуйтесь здравым смыслом и не забывайте, что тесты - это тоже код, который требует
поддержки и актуализации.

Строго
следуем [рекомендациям по модульному тестированию для .NET](https://learn.microsoft.com/ru-ru/dotnet/core/testing/unit-testing-best-practices)

## Локализация

Используйте английский язык для логирования событий приложения.

Для выдачи информационных сообщений пользователям используйте внутренний механизм реализации.

## Подходы к именованию

- Используйте для DTO-классов REST API именования Request-Response в неймспейсе Models
- Для постраничных запросов используйте семантику pageNumber (не Index) и pageSize с началом в единице
